---
title: "Distribución Uniforme Discreta"
lang: es
---

```{=html}
<style>
main.content {
text-align: justify}
</style>
```

```{r}
#| label: setup
#| include: false
library(tidyverse)
library(kableExtra)
library(gridExtra)
```

<br>

La **distribución uniforme discreta** es una de las distribuciones de probabilidad más elementales. Se caracteriza porque todos los valores posibles de la variable aleatoria tienen la misma probabilidad de ocurrir.

::: {#def-vaunif}
Una variable aleatoria discreta $X$ sigue una distribución uniforme discreta en el conjunto de $n$ números $\{x_1, x_2, \ldots, x_n\}$ si:

\begin{equation}
f(x) =  \begin{cases} 
\frac{1}{n} & \text{si } x \in \{x_1, x_2, \ldots, x_n\} \\
0 & \text{en otro caso}
\end{cases}
\end{equation}

Para denotar que una variable aleatoria $X$ tiene distribución uniforme escribimos:

\begin{equation}
X \sim \text{unif} \{x_1, x_2, \ldots, x_n\}
\end{equation}
:::

## Características Principales

**Función de Probabilidad**

\begin{equation}
f(x) = P(X = x) = \begin{cases} 
\frac{1}{n} & \text{si } x \in \{x_1, x_2, \ldots, x_n\} \\
0 & \text{en otro caso}
\end{cases}
\end{equation}

**Función de Distribución (Probabilidad Acumulada)**

Suponiendo que los valores $x_1, x_2, \ldots, x_n$ son $n$ enteros consecutivos, tenemos:

\begin{equation}
F(x) = P(X \leq x) = \begin{cases}
0 & \text{si } x < x_1 \\
\frac{\lfloor x \rfloor - x_1 + 1}{x_n-x_1+1} & \text{si } x_1 \leq x \leq x_n \\
1 & \text{si } x > x_n
\end{cases}
\end{equation}

**Parámetros Estadísticos**

Esperanza (Media):

\begin{equation}
E(X) = \frac{1}{n}\sum_{i=1}^n x_i = \mu
\end{equation}

Varianza:

\begin{equation}
\text{Var}(X) = \frac{1}{n}\sum_{i=1}^n (x_i-\mu)^2
\end{equation}

## Ejemplos y Aplicaciones

::: {#exm-dado}
### Lanzamiento de un dado

Un dado justo representa una distribución $X\sim \text{unif} \{1, 2, 3, 4, 5, 6\}$.

```{r}
#| code-fold: true
#| label: dado-ejemplo

# Parámetros del dado
x_1 <- 1
x_6 <- 6
valores <- x_1:x_6
probabilidades <- rep(1/length(valores), length(valores))

# Crear data frame
dado_data <- data.frame(
  Valor = valores,
  Probabilidad = probabilidades
)

# Mostrar tabla
kable(dado_data, 
      caption = "Distribución de probabilidad de un dado",
      align = "cc") %>%
  kable_styling(bootstrap_options = "striped")
```

**Cálculo de parámetros:**

```{r}
#| code-fold: true
#| label: parametros-dado
# Media
media <- sum(dado_data$Valor)/length(dado_data$Valor)
cat("Media:", media, "\n")

# Varianza
varianza <- sum((dado_data$Valor- media)^2)/length(dado_data$Valor)
cat("Varianza:", varianza, "\n")

# Desviación estándar
desv_std <- sqrt(varianza)
cat("Desviación estándar:", round(desv_std, 4), "\n")
```

### Visualización

```{r}
#| code-fold: true
#| label: grafico-dado
#| fig-cap: "Función de probabilidad de un dado"

ggplot(dado_data, aes(x = Valor, y = Probabilidad)) +
  geom_col(fill = "steelblue", alpha = 0.7, width = 0.6) +
  geom_text(aes(label = round(Probabilidad, 3)), vjust = -0.5) +
  scale_x_continuous(breaks = valores) +
  scale_y_continuous(limits = c(0, 0.20)) +
  labs(title = "Distribución Uniforme Discreta - Dado",
       x = "Valor",
       y = "Probabilidad") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))
```
:::

::: {#exm-num_random}
### Selección aleatoria de números

Supongamos que seleccionamos aleatoriamente un número entero entre 10 y 20 (inclusive).

**Cálculo de parámetros:**

```{r}
#| code-fold: true
#| label: ejemplo-numeros

x2_1 <- 10
x2_n <- 20
valores2 <- x2_1:x2_n
probabilidades2 <- rep(1/(length(valores2)), length(valores2))

# Data_frame
data2 <- data.frame(
  Valor = valores2,
  Probabilidad = probabilidades2
)

# Parámetros estadísticos
media2 <- mean(data2$Valor)
varianza2 <- sum((data2$Valor - media2)^2)/length(data2$Valor)
desv_std2 <- sqrt(varianza2)

cat("Media:", media2, "\n")
cat("Varianza:", round(varianza2, 4), "\n")
cat("Desviación estándar:", round(desv_std2, 4), "\n")
```

**Visualización de la función de probabilidad:**

```{r}
#| label: grafico-numeros
#| fig-cap: "Distribución uniforme discreta entre 10 y 20"


ggplot(data2, aes(x = Valor, y = Probabilidad)) +
  geom_col(fill = "darkgreen", alpha = 0.7, width = 0.8) +
  geom_text(aes(label = round(Probabilidad, 3)), 
            vjust = -0.5, size = 3) +
  scale_x_continuous(breaks = seq(10, 20, 1)) +
  labs(title = "Distribución Uniforme Discreta",
       x = "Valor",
       y = "Probabilidad") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))
```
:::

::: {#exm-simulacion}
### Simulación en R

Generación de números aleatorios de una variable aleatoria $X\sim unif\{1, 2, 3, 4, 5, 6\}$ y comparación con las probabilidades teóricas.

```{r}
#| code-fold: true
#| label: simulacion

# Generar 1000 números aleatorios
set.seed(123)
n_sim <- 1000
muestra <- sample(1:6, n_sim, replace = TRUE)

# Frecuencias observadas
freq_obs <- table(muestra)
freq_rel <- prop.table(freq_obs)

# Comparar con probabilidades teóricas
comparacion <- data.frame(
  Valor = 1:6,
  Prob_Teorica = rep(1/6, 6),
  Freq_Observada = as.numeric(freq_rel)
)

kable(comparacion, 
      caption = "Comparación entre probabilidades teóricas y observadas",
      col.names = c("Valor", "Prob. Teórica", "Freq. Observada"),
      digits = 4) |> 
  kable_styling(bootstrap_options = "striped")
```

<br>

**Visualización de la simulación**

```{r}
#| code-fold: true
#| label: grafico-simulacion
#| fig-width: 8
#| fig-height: 6
#| fig-align: "center"
#| fig-cap: "Comparación entre distribución teórica y simulada"


# Preparar datos para el gráfico
comp_long <- comparacion |> 
  pivot_longer(cols = c(Prob_Teorica, Freq_Observada),
               names_to = "Tipo",
               values_to = "Probabilidad") |> 
  mutate(Tipo = case_when(
    Tipo == "Prob_Teorica" ~ "Teórica",
    Tipo == "Freq_Observada" ~ "Observada"
  ))

ggplot(comp_long, aes(x = Valor, y = Probabilidad, fill = Tipo)) +
  geom_col(position = "dodge", alpha = 0.7) +
  scale_x_continuous(breaks = 1:6) +
  scale_fill_manual(values = c("Teórica" = "blue", "Observada" = "red")) +
  labs(title = paste("Simulación con", n_sim, "observaciones"),
       x = "Valor",
       y = "Probabilidad",
       fill = "Distribución") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "bottom")
```
:::

## Aplicaciones Prácticas

La distribución uniforme discreta tiene múltiples aplicaciones:

1.  **Juegos de azar**: Dados, ruletas, sorteos
2.  **Muestreo**: Selección aleatoria de elementos
3.  **Simulación**: Generación de números aleatorios equiprobables
4.  **Investigación**: Asignación aleatoria de tratamientos

## Propiedades Importantes

### Relación con otras distribuciones

-   Caso especial de la distribución categórica con probabilidades iguales
-   Límite discreto de la distribución uniforme continua
-   Base para generar otras distribuciones discretas

### Teorema Central del Límite

Verifiquemos el Teorema Central del Límite mediante simulación para el caso de variables aleatorias con distribución uniforme discreta.

Generaremos $k=1000$ muestras cada una de tamaño $n=30$ de una distribución uniforme discreta en el conjunto $\{1, 2, 3, 4, 5, 6\}$ y observaremos la distribución de sus medias muestrales. En el @exm-dado se obtuvo que para $X\sim \text{unif}\{1, 2, 3, 4, 5, 6\}$ tenemos $\mu=7/2$ y $\sigma^2= 35/12$, luego la media muestral:

$$\bar{X}_{30}=\frac{1}{30}\sum_{i=1}^{30} X_i$$ Tendrá aproximadamente la siguiente distribución:

$$\bar{X}_n \sim N\left(\mu, \frac{\sigma^2}{n} \right)$$

Es decir

$$\bar{X}_{30} \sim N\left(\frac{7}{2}, \frac{7}{72} \right)$$

```{r}
#| code-fold: true
#| label: limite-central
#| fig-width: 8
#| fig-height: 6
#| fig-align: "center"
#| fig-cap: "Verificación del Teorema del Límite Central"
# Simular medias muestrales
set.seed(456)
k_muestra <- 1000
n_muestra <- 30

medias_muestrales <- replicate(k_muestra, {
  muestra <- sample(1:6, n_muestra, replace = TRUE)
  mean(muestra)
})

# Crear histograma
hist_data <- data.frame(Medias = medias_muestrales)

ggplot(hist_data) +
  geom_histogram(aes(x=Medias, after_stat(density)), bins = 30, 
                 fill = "lightblue", alpha = 0.7, color = "black") +
  geom_density(aes(x = Medias), color = "red", linewidth = 1) +
  geom_vline(xintercept = mean(medias_muestrales), 
             color = "blue", linetype = "dashed", linewidth = 1) +
  labs(title = "Distribución de Medias Muestrales",
       subtitle = paste("n =", n_muestra, " de una v.a. uniforme(1,6)"),
       x = "Media Muestral",
       y = "Densidad") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))

# Estadísticas
cat("Media teórica:", (1+6)/2, "\n")
cat("Media observada:", round(mean(medias_muestrales), 4), "\n")
cat("Varianza teórica de la media:", round(((6-1+1)^2-1)/12/n_muestra, 4), "\n")
cat("Varianza observada de la media:", round(var(medias_muestrales), 4), "\n")
```

## Ejercicios Propuestos

::: {#exr-muestras}
Una urna contiene 8 bolas numeradas del 1 al 8. Se extrae una bola al azar. Calcule la probabilidad de obtener un número par.

```{r}
total_bolas <- 8
numeros_bolas <- 1:total_bolas
numeros_pares <- numeros_bolas[numeros_bolas %% 2 == 0]
cantidad_pares <- length(numeros_pares)
prob_par <- cantidad_pares / total_bolas

df_bolas <- data.frame(
  numero = numeros_bolas,
  tipo = ifelse(numeros_bolas %% 2 == 0, "Par", "Impar"),
  probabilidad = 1/total_bolas
)

# Gráfico de distribución
ggplot(df_bolas, aes(x = factor(numero), y = probabilidad, fill = tipo)) +
  geom_col(color = "black", alpha = 0.8) +
  geom_text(aes(label = paste0("P = ", round(probabilidad, 3))), 
            vjust = -0.5, size = 3.5, fontface = "bold") +
  labs(title = "Distribución de Probabilidad - Extracción de Bola",
       x = "Número de la Bola",
       y = "Probabilidad",
       fill = "Tipo") +
  theme_minimal() +
  scale_fill_manual(values = c("Par" = "lightblue", "Impar" = "lightcoral")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1)) +
  theme(legend.position = "bottom") +
  annotate("text", x = 4.5, y = max(df_bolas$probabilidad) * 1.1,
           label = paste("P(Par) =", cantidad_pares, "/", total_bolas, "=", prob_par),
           color = "darkblue", fontface = "bold", size = 5)

```

```{r}

numeros_impares <- numeros_bolas[numeros_bolas %% 2 == 1]
cantidad_impares <- length(numeros_impares)
prob_impar <- cantidad_impares / total_bolas
numeros_mayor_4 <- numeros_bolas[numeros_bolas > 4]
cantidad_mayor_4 <- length(numeros_mayor_4)
prob_mayor_4 <- cantidad_mayor_4 / total_bolas

es_primo <- function(n) {
  if (n < 2) return(FALSE)
  if (n == 2) return(TRUE)
  if (n %% 2 == 0) return(FALSE)
  for (i in 3:sqrt(n)) {
    if (n %% i == 0) return(FALSE)
  }
  return(TRUE)
}

numeros_primos <- numeros_bolas[sapply(numeros_bolas, es_primo)]
cantidad_primos <- length(numeros_primos)
prob_primo <- cantidad_primos / total_bolas
eventos <- c("Par", "Impar", "> 4", "Primo")
probabilidades <- c(prob_par, prob_impar, prob_mayor_4, prob_primo)
casos_favorables <- c(cantidad_pares, cantidad_impares, cantidad_mayor_4, cantidad_primos)

df_comparativo <- data.frame(
  evento = eventos,
  probabilidad = probabilidades,
  casos_favorables = casos_favorables
)

# Gráfico de comparación
ggplot(df_comparativo, aes(x = reorder(evento, -probabilidad), y = probabilidad, fill = evento)) +
  geom_col(color = "black", alpha = 0.8) +
  geom_text(aes(label = paste0(casos_favorables, "/", total_bolas, "\n", 
                              round(probabilidad * 100, 1), "%")), 
            vjust = -0.3, size = 4, fontface = "bold") +
  labs(title = "Comparación de Probabilidades - Diferentes Eventos",
       x = "Evento",
       y = "Probabilidad") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set2") +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1), 
                     limits = c(0, 0.6)) +
  theme(legend.position = "none")

```

:::

::: {#exr-enteros}
En un juego, se selecciona aleatoriamente un número entero entre 5 y 15 (inclusive). Calcule la media y la varianza de esta distribución.

```{r}
min_valor <- 5
max_valor <- 15
valores_posibles <- min_valor:max_valor
n <- length(valores_posibles)

media_teorica <- (min_valor + max_valor) / 2
suma_valores <- sum(valores_posibles)
media_manual <- suma_valores / n

varianza_teorica <- ((max_valor - min_valor + 1)^2 - 1) / 12
valores_cuadrados <- valores_posibles^2
suma_cuadrados <- sum(valores_cuadrados)
E_X2 <- suma_cuadrados / n
varianza_manual <- E_X2 - media_teorica^2

probabilidad_uniforme <- 1/n

df_distribucion <- data.frame(
  numero = valores_posibles,
  probabilidad = probabilidad_uniforme
)

# Gráfico de la distribución
ggplot(df_distribucion, aes(x = factor(numero), y = probabilidad)) +
  geom_col(fill = "lightblue", color = "black", alpha = 0.8, width = 0.7) +
  geom_vline(xintercept = which(valores_posibles == media_teorica), 
             color = "red", linetype = "dashed", linewidth = 1) +
  geom_hline(yintercept = probabilidad_uniforme, color = "blue", 
             linetype = "dotted", linewidth = 0.8) +
  labs(title = "Distribución Uniforme Discreta",
       x = "Número Seleccionado",
       y = "Probabilidad") +
  theme_minimal() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1)) +
  annotate("text", x = which(valores_posibles == media_teorica), 
           y = max(df_distribucion$probabilidad) * 1.1,
           label = paste("Media =", media_teorica), 
           color = "red", fontface = "bold") +
  annotate("text", x = length(valores_posibles)/2, y = probabilidad_uniforme * 0.5,
           label = paste("P(X = x) = 1/", n, "≈", round(probabilidad_uniforme, 3)),
           color = "blue", fontface = "bold")

```

```{r}
set.seed(123)
n_simulaciones <- 100000
selecciones <- sample(valores_posibles, n_simulaciones, replace = TRUE)
media_simulada <- mean(selecciones)
varianza_simulada <- var(selecciones)
desviacion_simulada <- sd(selecciones)

rango <- max_valor - min_valor
amplitud <- rango + 1

df_densidad <- data.frame(
  x = seq(min_valor - 1, max_valor + 1, length.out = 1000),
  tipo = "Continua"
)
df_densidad$y <- dunif(df_densidad$x, min = min_valor - 0.5, max = max_valor + 0.5)

ggplot() +
  geom_line(data = df_densidad, aes(x = x, y = y, color = "Continua"), 
            linewidth = 1, alpha = 0.7) +
  geom_segment(data = df_distribucion, 
               aes(x = numero - 0.5, xend = numero + 0.5, 
                   y = probabilidad, yend = probabilidad, color = "Discreta"),
               linewidth = 2) +
  geom_point(data = df_distribucion, 
             aes(x = numero, y = probabilidad, color = "Discreta"),
             size = 3) +
  geom_vline(xintercept = media_teorica, color = "red", 
             linetype = "dashed", linewidth = 1) +
  labs(title = "Comparación: Uniforme Discreta vs Continua",
       x = "Valor",
       y = "Densidad/Probabilidad",
       color = "Tipo de Distribución") +
  theme_minimal() +
  scale_color_manual(values = c("Discreta" = "blue", "Continua" = "gray")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 0.1)) +
  annotate("text", x = media_teorica, y = max(df_distribucion$probabilidad) * 1.2,
           label = paste("Media =", media_teorica), 
           color = "red", fontface = "bold")
```

:::

::: {#exr-simulacion_4}
Simule 500 observaciones de una distribución uniforme discreta en {0, 1, 2, 3, 4} y compare las frecuencias observadas con las teóricas.

```{r}

#Valores simulados
valores <- 0:4
sim_values <- sample(valores, 500, replace = TRUE)

media_teorica <- sum(valores)/length(valores)
media_muestral1 <- mean(sim_values)

varianza_teorica <- sum((valores-media_teorica)^2)/length(valores)
varianza_muestral <- var(sim_values)

cat("Media teorica: ", media_teorica, "\n")
cat("Media muestral: ", round(media_muestral1,3), "\n")
cat("Varianza teorica: ", varianza_teorica, "\n")
cat("Varianza muestra: ", round(varianza_muestral,3), "\n")
```

```{r}

#Tabla de frecuencias
frecuencias <- table(sim_values)

tabla_frecuencias <- tibble(
  valor = valores,
  Frec_teorica = rep(100,5),
  Frec_observada = frecuencias
)

tabla_frecuencias_long <- tabla_frecuencias

```

:::
